<!DOCTYPE html>
<html lang="en">
<head>
<title>MyProctor.ai</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.7/css/all.css">

<!-- Volt CSS -->
<link type="text/css" rel="stylesheet" href="{{ url_for('static', filename='volt/css/volt.css') }}">

<!-- Favicon -->
<link rel="icon" type="image/png" href="{{ url_for('static', filename='volt/assets/img/favicon/favicon-32x32.png') }}">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>

<style>
  body {
    display: flex;
    min-height: 100vh;
    margin: 0;
    overflow-x: hidden;
  }

  /* Sidebar */
  #sidebarMenu {
    width: 250px;
    flex-shrink: 0;
    height: 100vh;
    background-color: #212529;
    color: white;
    position: fixed;
    left: 0;
    top: 0;
    overflow-y: auto;
  }

  /* Main content area */
  main.content {
    margin-left: 250px;
    padding: 20px;
    flex-grow: 1;
    background-color: #f8f9fa;
    min-height: 100vh;
  }

  .nav-link {
    color: #fff !important;
  }
  .nav-link:hover {
    background-color: #343a40;
    color: #fff !important;
  }
</style>
</head>

<body>

<!-- ✅ Sidebar (Left) -->
<nav id="sidebarMenu" class="sidebar d-flex flex-column p-3">
  <center>
    <lottie-player src="https://assets1.lottiefiles.com/packages/lf20_wEt2nn.json" background="transparent" speed="1" style="width: 100px; height: 80px;" loop autoplay></lottie-player>
  </center>
  <h5 class="text-center text-light mb-3">{{ session.name }}</h5>

  <ul class="nav nav-pills flex-column mb-auto">
    <li><a class="nav-link" data-bs-toggle="collapse" href="#createExam" role="button"><i class="fas fa-plus me-2"></i>Create Exam</a></li>
    <div class="collapse ps-3" id="createExam">
      <a href="/create-test" class="nav-link">Objective</a>
      <a href="/create_test_lqa" class="nav-link">Subjective</a>
      <a href="/create_test_pqa" class="nav-link">Practical</a>
    </div>

    <li><a href="/generate_test" class="nav-link"><i class="fas fa-magic me-2"></i>Generate Questions</a></li>
    <li><a href="/viewquestions" class="nav-link"><i class="fas fa-eye me-2"></i>View Questions</a></li>
    <li><a href="/updatetidlist" class="nav-link"><i class="fas fa-edit me-2"></i>Update Questions</a></li>
    <li><a href="/deltidlist" class="nav-link"><i class="fas fa-trash-alt me-2"></i>Delete Questions</a></li>
    <li><a href="/{{session.email}}/disptests" class="nav-link"><i class="fas fa-history me-2"></i>Exam History</a></li>
    <li><a href="/livemonitoringtid" class="nav-link"><i class="fas fa-video me-2"></i>Live Monitoring</a></li>
    <li><a href="/viewstudentslogs" class="nav-link"><i class="fas fa-binoculars me-2"></i>Student Monitoring</a></li>
    <li><a href="/insertmarkstid" class="nav-link"><i class="fas fa-spell-check me-2"></i>Insert Marks</a></li>
    <li><a href="/publish-results-testid" class="nav-link"><i class="fas fa-clipboard-check me-2"></i>Publish Results</a></li>
    <li><a href="/{{session.email}}/tests-created" class="nav-link"><i class="fas fa-poll me-2"></i>Results</a></li>

    <hr class="bg-light">
    <li><a href="/report_professor" class="nav-link"><i class="fas fa-bug me-2"></i>Report Problems</a></li>
    <li><a href="/payment" class="nav-link"><i class="fas fa-money-bill me-2"></i>Payment</a></li>
    <li><a href="/changepassword_professor" class="nav-link"><i class="fas fa-key me-2"></i>Change Password</a></li>

    <li class="mt-3">
      <button onclick="funLogout()" class="btn btn-danger w-100"><i class="fas fa-sign-out-alt me-2"></i>Logout</button>
    </li>
  </ul>
</nav>

<!-- ✅ Main Content (Right) -->
<main class="content">
  <div class="container-fluid px-4">
    {% include 'includes/_messages.html' %}
    {% block body %}
    <div class="card shadow-sm">
      <div class="card-body">
        <h3>Welcome, {{session.name}}</h3>
        <p class="text-muted">Use the left sidebar to navigate between features.</p>
      </div>
    </div>
    {% endblock %}
  </div>

  <footer class="mt-5 text-center text-muted small">
    <p>Copyright © MyProctor.ai <script>document.write(new Date().getFullYear())</script> — All rights reserved.<br>Made with ❤️ by Suriya V</p>
  </footer>
</main>

<!-- ✅ Working Logout Function -->
<script>
function funLogout() {
  Swal.fire({
    title: 'Are you sure?',
    text: "Do you really want to logout?",
    icon: 'warning',
    showCancelButton: true,
    confirmButtonText: 'Yes, logout me!',
    cancelButtonText: 'No!',
    confirmButtonColor: '#d33',
    cancelButtonColor: '#202124',
  }).then((result) => {
    if (result.isConfirmed) {
      $.ajax({
        type: "POST",
        url: "/logout",
        success: function(response) {
          if (response.trim() === "success") {
            Swal.fire({
              title: 'Logged out!',
              text: 'You have successfully signed out.',
              icon: 'success',
              timer: 1500,
              showConfirmButton: false
            }).then(() => {
              window.location.href = "/login";
            });
          } else {
            Swal.fire('Error!', 'Logout failed. Please try again.', 'error');
          }
        },
        error: function() {
          Swal.fire('Error!', 'Server not responding.', 'error');
        }
      });
    }
  });
}
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
